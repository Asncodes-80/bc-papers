\documentclass[10pt, a4paper]{article}
\usepackage{float}
\usepackage{geometry}
\usepackage{listings}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{ragged2e}
\usepackage{color}
\usepackage{xepersian}
\usepackage{subfiles}
\usepackage{multirow}
% Main configuration commands
\input{./modules/config/commands.tex}

\title{مفاهیم اولیه بلاک چین}
\author{\href{mailto:a.soltani@iau-tnb.ac.ir}{علیرضا سلطانی نشان}}

\begin{document}
\maketitle
\tableofcontents

\section{مجوز}

به فایل مجوز که همراه این برگه قرار دارد توجه کنید. لازم به ذکر است که این برگه
تابع مجوز GPLv3 می‌باشد که به مخاطب اجازه می‌دهد بدون هیچ گونه محدودیتی، کد و
خروجی/pdf مربوطه را به صورت رایگان منتشر و استفاده کند.

\section{مقدمه}

جزوه‌ای که اکنون در حال خواندن آن هستید معرفی مفاهیم اولیه و بسیار مهم بلاک چین
است که با تمرکز بر روی بیت‌کوین نوشته شده است. مرجع اصلی این جزوه کتاب
\lr{Bitcoin and Cryptocurrency Technologies} می‌باشد. دیدگاهی بسیار قابل توجهی
در این جزوه بر اساس بستر بیت‌کوین می‌باشد.

\section{تاریخچه}

\subsection{مشکل \lr{Double spending}}

یکی از چالش‌های پول دیجیتال در دیدگاه اول، قابلیت کپی گرفتن و دوبار خرج کردن یک
پول می‌باشد. یک کاربر نباید قادر به خرج مجدد یک پول باشد. پول‌های کاغذی را
نمی‌توان به راحتی کپی کرد چرا که دشوار هستند و توسط یک نهاد یا بانک مرکزی
اصطلاحاً تایید شده نمی‌باشد. اما در پول‌های دیجیتال چون در مفهوم دیجیتال و
کامیپوتری شده پدید آمدند ممکن است امکان کپی کردن یک پول وجود داشته باشد. به همین
خاطر برای جلوگیری از این پدیده باید یک مرکزی تعریف شود که تمام تراکنش‌های
کاربران را در آن یادداشت می‌کند و در آن مشخص می‌شود که هر کاربر چه تراکنشی انجام
داده است که در ادامه به مفهوم \lr{Ledger} می‌پردازیم. مهم‌ترین پیچیدگی این
پول‌ها در مصرف همزمان آنها می‌باشد.

\subsection{ساختار پول}

\subsubsection{پول‌ها و ارز‌های Fiat}

منشا اصلی تمام پول‌های امروزی که در حال استفاده از آن‌ها هستیم دولت، بانک مرکزی
و یا دیگر سازمان‌های معتبری در دولت (سطح کشوری و یا سطح جهانی مانند دلار) هستند
که در واقع اصل بودن ارزش آن‌ها را ثابت می‌کنند. با این وجود به دلیل تمرکز آنها
به یک نهاد یا سازمان در عمل قابل کنترل و پیگیری هستند. تمام پول‌ها (شامل طلا و
غیره) حاوی تاریخچه‌ای از تبادلات و دادوستد‌ها هستند. برای مثال اگر امروز شما ۱۰۰
دلار بدست آورید کاملا توسط دولت قابل پیگیری است که این ۱۰۰ دلار در بانک به نام
شما ثبت شده است.

\subsubsection{پول‌ها و ارز‌های دیجیتال}

در پول‌های دیجیتال مهم‌ترین ایده رمز ارز بودن آن است که توسط الگوریتم‌های
رمزنگاری تولید شده است. حاوی تاریخچه است که تمام تبادلات آن موجود می‌باشد. هش
کردن و امضای دیجیتال از رویکرد‌های اولیه ساخت این پول می‌باشد.

\subsubsection{مشکلات}

مهم‌ترین چالش رمز ارز‌های اولیه و پول‌های سنتی وجود سیستم‌های متمرکز و مشکل
\lr{Double spending} می‌باشد.

\subsection{راهکار \lr{Ledger}}

دیتابیسی از سوابق تبادل و انتقالات تراکنش‌ها می‌باشد که مشخص می‌کند هر کاربر چه
تراکنشی را به چه سمتی انتقال داده است. در این دیتابیس تمام موارد \lr{Double
spend} مورد بررسی قرار می‌گیرد که یک کاربر نتواند از یک تراکنش دوبار عمل انتقال
را انجام دهد. در حقیقت راهکاری برای جلوگیری از کلون و کپی گرفتن از انتقال
تراکنش‌ها می‌باشد.

\section{نظریه ارزش}

کمیاب بودن یک چیز باعث ارزشمند شدن آن می‌شود. اگر طلا ارزشمند است چون منابع طلا
همه جا نیست.

\section{خاصیت‌های هش مرسوم}

یک هش مرسوم سه ویژگی دارد:

\begin{enumerate}
    \item ورودی آزاد
    \item طول مشخص خروجی تابع
    \item در یک زمان معقول قابل پردازش باشد \lr{O(n)}
\end{enumerate}

\section{خاصیت‌های هش رمزارز‌ها}

\begin{enumerate}
    \item تصادم پذیر نباشد \footnote{\lr{Collision resistance}}
    \begin{enumerate}
        \item هیچ فردی نتواند تصادم را پیدا کند
    \end{enumerate} 
    \item مخفی باشد \footnote{\lr{Hiding}}
    \begin{enumerate}
        \item رمزنگاری یک طرفه می‌باشد که از خروجی هیچ وقت نمی‌توان به ورودی
        رسید
    \end{enumerate} 
    \item قابل جست و جوی فراگیر نباشد \footnote{\lr{Puzzle friendliness}}
    \begin{enumerate}
        \item سرعت آن بهینه باشد ولی به قدری سریع نباشد که بتوان از طریق
        تکنیک‌های \lr{Bruteforce} خیلی راحت به جواب رسید.
    \end{enumerate}
\end{enumerate}

\section{امضا‌ها}

بر اساس کلید‌های خصوصی-عمومی کار می‌کند.  دو قفل وجود دارد که کاربر می‌تواند
پیام اصلی خود را با استفاده از قفل خصوصی آن را رمزنگاری کند و به یک امضا برسد و
در نهایت با استفاده از کلید عمومی و با شرایطی خاص به پیام اصلی برسد.  هر پیامی
می‌تواند با کلید خصوصی منجر به تولید یک امضا شود. هر کسی می‌تواند به کلید عمومی
کاربری دسترسی داشته باشد. اما تا زمانی که صاحب کلید نباشد نمی‌تواند به اصل پیام
برسد. به عبارتی دیگر اگر کاربری بخواهد با استفاده از کلید عمومی، پیام اصلی و
امضای تولید شده یک کاربر دیگر به کلید خصوصی برسد با استفاده از تابعی امکان پذیر
می‌باشد. 

\subsection*{الگوریتم‌های تولید کلید}

\begin{enumerate}
    \item PGP
    \item :GPG بر گرفته از بنیاد GNU می‌باشد.
    \item :ECDSA ساخته شده توسط دولت آمریکا می‌باشد که بر اساس فرمول ریاضی کار
    می‌کند. \footnote{\lr{Elliptic Curve Digital Signature Algorithm}}
\end{enumerate}

\subsection*{نکات}

\begin{itemize}
    \item داده‌ها در بلاک چین به صورت هش تبادل می‌شوند
    \item در بلاک چین نیازی به داشتن امضای دیجیتال نیست
    \item در رمزارز‌ها نیازمند به امضا‌های دیجتال هستیم
\end{itemize}

\subsection{خصوصیات کلید عمومی}

\begin{enumerate}
    \item کلید خصوصی شناسه اصلی کاربر می‌باشد:
    \begin{enumerate}
        \item نیازی به نام کاربری نیست
        \item نیازی در مراجعه به تولید کننده کلید نسیت
        \item یک کاربر می‌تواند تعداد زیادی کلید عمومی تولید کند که مربوط به
        خودش باشد اما کاربران دیگران نمی‌توانند از طریق این کلید‌های عمومی به
        شخص مورد نظر برسند.
    \end{enumerate}
\end{enumerate}

\section{بلاک چین چیست؟}

در ابتدا باید مفهوم بلاک را بتوانیم درک کنیم. هر بلاک ساختمان داده‌ای است که
محتوای آن شامل بخش‌های زیر می‌باشد:

\begin{itemize}
    \item تراکنش‌ها (TRX)
    \item زمان اتفاق تراکنش‌ها (Timestamp)
    \item و سپس هش آن محاسبه شود
\end{itemize}

به مجموعه‌ای از این بلاک‌ها که اطلاعات آنها به یکدیگر متصل و مرتبط می‌باشد بلاک
چین یا زنجیره‌ای از بلاک‌هایی که ساختار آنها را درک کردیم می‌گویند. یک شکلی از
دیتابیس توزیع شده است که ارز‌های دیجیتال مانند بیت‌کوین بر اساس آن طراحی شده
است. بلاک چین بدون بیت‌کوین وجود دارد و می‌توان از طریق آن داده‌های مختلفی را
انتقال داد. داده‌ها در قالب بلاک‌ها نگهداری می‌شوند. یک شبکه توزیع شده و هیچ
بدون هیچ مرکزیت داده‌ای.

نمونه‌ای از ساختار یک بلاک انتقال داده در شبکه توزیع شده بلاک چین:

\begin{LTR}
    \begin{lstlisting}
    {
        "hash": "0x453bb640641fe0c2555d07746efdf200993103ed07007f3236d855c66c358745",
        "blockHash": "0x2acb514f608fe7ace34e22103c3109d81bebc1b78e74ae089cf8902b9bc30836",
        "blockNumber": "19033018",
        "to": "0xe507c2e03593350135b79a4efba464f27912ba39",
        "from": "0xa9389f90a1a044a8e5a492447b5a5bb8f023e167",
        "value": "9600000000000000",
        "nonce": "143",
        "gasPrice": "32533243150",
        "gasLimit": "25397",
        "gasUsed": "21164",
        "data": "1020240118100046276945",
        "transactionIndex": "144",
        "success": true,
        "state": "CONFIRMED",
        "timestamp": "1705572059",
        "internalTransactions": []
    }
    \end{lstlisting}
\end{LTR}

\section{مسئله اجماع}

بزرگ‌ترین چالش در سیستم‌های توزیع شده مسئله اجماع می‌باشد مخصوصا در شرایطی که
برخی از اجزا ممکن است عملکرد نامناسبی داشته باشند و از کار بیفتند و یا غیر قابل
اعتماد باشند. به همین خاطر در مورد اجماع در سیستم‌های توزیع شده تئوری ژنرال‌های
بیزانس مطرح می‌شود. در حالی که ژنرال‌ها در انتظار دریافت پیام از پیام آوران در
ناحیه‌های مختلفی (کاملا به صورت توزیع شده در شهر‌های مختلف) هستند ممکن است به
دلایل مختلفی پیام حمله برای هر ژنرالی با مشکلی مواجه شود. ممکن است یکی از
پیام‌آوران در هنگام آمدن به سمت ژنرال شهر (آ) از گشنگی بمیرد و یکی دیگر از
پیام‌آوران حمله به ژنرال شهر (ب) به اسارت گرفته شود و نتواند پیام حمله را به سمت
ژنرال آن شهر ببرد در همین حال سه پیام‌آور دیگر به شهر‌های مقصد به سلامتی می‌رسند
و پیام را به ژنرال‌ها انتقال می‌دهند اما چون خبری از اقدامات بقیه ژنرال‌ها در
شهر‌های مختلف ندارند، فرض را بر این می‌گذارند که ژنرال‌های شهر‌های دیگر پیام
حمله را دریافت کردند. به همین خاطر به دلیل آن که هیچ ژنرالی با ژنرال‌های دیگر به
اجماع نرسیدند احتمال موفقیت آن ها به شدت کم خواهد بود و ممکن است شکست خورند.

در دیتابیس‌های بلاک چین نیز همین مسئله وجود دارد. برای رسیدن به اجماع در عمل
یکسری شرایط وجود دارد:

\begin{itemize}
    \item برای سیستم‌ها و افرادی که در دیتابیس‌های بلاک چین عملکرد خوبی دارند
    مشوقی \footnote{\lr{Incentive}} در نظر گرفته شود که آنها به خوب بودن خودشان
    ادامه دهند.
    \item انتخاب افراد خوب به صورت کاملا تصادفی می‌باشد
\end{itemize}

اما در این بین باید فراموش نکرد که برای رسیدن به این اجماع می‌تواند سختی‌هایی هم
وجود داشته باشد:

\begin{itemize}
    \item تا آنجایی که می‌شود از حمله‌های \lr{Sybil} جلوگیری شود. چرا که ممکن
    است هر کامپیوتر در شبکه توزیع شده بلاک چین از خود چندین کپی گیرد و چون تعداد
    سیستم‌هایش زیاد است احتمال دریافت تشویقش زیادتر نسبت به بقیه سیستم‌های حاضر
    در شبکه می‌شود
    \item انتخاب‌ها نباید همینطوری به صورت تصادفی باشد زیرا هر گره در این شبکه
    لزومی ندارد یک سیستم عادل و شایسته‌ای برای دریافت تشویق باشد.
\end{itemize}

پاداش هر سیستمی که بتواند بلاکی را پیدا کند یک مقدار مشخصی از بیت‌کوین می‌باشد.

\section{اجماع ضمنی}

لزومی ندارد که تمام سیستم‌ها طبق یک فرمول دقیق یک \lr{Ledger} وجود داشته باشد
بلکه به صورت ضمنی امروزه این اجماع دیده می‌شود.


\end{document}